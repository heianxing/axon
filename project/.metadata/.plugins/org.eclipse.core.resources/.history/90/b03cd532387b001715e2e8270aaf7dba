package com.sundy.axon.unitofwork;

/**
 * 该类代表一个能够修改聚合根的工作单元，一个典型的工作单元的范围是一个命令的执行。一个工作单元主要用于，防止在聚合根被处理完成前，单个的事件被发布出去。
 * 它也能通过仓库来管理资源，比如 锁。事务，比如锁在事件已提交或回滚后才能释放
 * <p/>
 * 获取当前工作单元 可以通过 {@link CurrentUnitOfWork#get()}
 * @author Administrator
 *
 */
public interface UnitOfWork {

	void commit();
	
	void rollback();
	
	void start();
	
	boolean isStarted();
	
	boolean isTransactional();
	
	void registerListener(UnitOfWOrkListner listener);
	
	<T extends Aggregate> T registerAggregate(T aggregateRoot, EventBus eventBus, SaveAggregateCallback<T> saveAggregateCallback);
	
	void publishEvent(EventMessage<?> event, EventBus eventBus);
	
	void attachResource(String name, Object resource);
	
	void attachResource(String name, Object resource, boolean inherited);
	
	<T> T getResource(String name);
	
	void attachInheritedResources(UnitOfWork inheritingUnitOfWork);
	
}
